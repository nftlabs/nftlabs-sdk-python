# Thirdweb Python SDK

The official SDK for working with Thirdweb, in Python.

## Installation.

**Python 3.6 or above is required.**

```sh
# Windows
py -3 -m pip install -U  thirdweb-sdk

# Linux or MacOS
python3 -m pip install -U  thirdweb-sdk

# Install the nightly build
python3 -m pip install -U git+https://github.com/nftlabs/nftlabs-sdk-python
```

## Usage.

You can easily get started by using the SDK as so.

```py
# Imports.
import os
from nftlabs import NftlabsSdk, SdkOptions

# Use the polygon testnet.
sdk = NftlabsSdk(SdkOptions(), "https://rpc-mumbai.maticvigil.com")

# Assumes your private key is assigned to the `PKEY` environment variable.
sdk.set_private_key(os.getenv("PKEY"))

# Put your NFT contract address here if you want to mint your own NFTs!
nft_module = sdk.get_nft_module("0xbDfF8fb43688fB4D2184DF8029A7238ac1413A24")

# Print out the total supply.
print(nft_module.total_supply())
```

## Package structure for the project.

```
thirdweb
├── abi       → contains autogenerated ABI contract wrappers
├── errors    → commonly thrown errors
├── modules   → NFT, Currency, Marketplace, Pack, Bundle, etc modules
├── options   → Options classes used throughout the SDK
├── sdk.py    → NftlabsSdk class, wrapper for the entire package
├── storage   → Distributed file storage helper classes
└── types     → Types consumed by some of the methods exposed in the modules
```

## Development

### Generating ABI wrappers

The `abi` package contains autogenerated code compiled by the
0xchain `abi-gen` tool found [here](https://www.npmjs.com/package/@0x/abi-gen).

Our protocols are developer at [this repo](https://github.com/nftlabs/nftlabs-protocols).

Install the `abi-gen` cli tool and use it to compile abi wrappers like this:

```bash
$ # assumes you have the nftlabs-protocols repo cloned in the parent directory
$ abi-gen --language Python -o nftlabs/abi --abis ../nftlabs-protocols/abi/NFT.json
```

Anytime there are ABI contract changes, you should regenerate the abi wrappers.

### Writing Documentation

This package uses [`PyDoctor`](https://github.com/twisted/pydoctor) to auto-generate docs. Each method, class and variable should have a detailed description of what it is meant for as a comment enclosed in triple quoation marks (`""" """`) just below the line they are defined.

Example:

Do:

```python
def my_method(self, arg1, arg2):
    """This part goes into the documentation."""
    return arg1 + arg2

# For longer documentation.
def my_method_2(self, arg1, arg2):
    """
    This part goes into the documentation.

    This is a longer description.
    """
    return arg1 + arg2
```

Don't:

```python
"""This part will not go into the documentation."""

def my_method(self, arg1, arg2):
    return arg1 + arg2
```

Addtionally, each module should also have a docstring at the top of the file. This will be used as a breif descroption of the module on the [homepage of the documentation](https://python-docs.thirdweb.com/).

Example:

```python
1 """Interact with the NFT module of the app""" # docstring
2 # Module code starts from here
3 # ...
```

## Contributing

Contributions, issues and feature requests are welcome. After cloning & setting up project locally, you can just submit a PR to this repo and it will be deployed once it's accepted.

Here are some guidelines for how to contribute:

## Linting and Pre-commit

We make use of `flake8` and `pre-commit` to ensure that the code style is consistent across the code base.

Running `flake8` will warn you about any potential style errors in your contribution. You must always check
it before pushing. Your commit will be rejected by the build server if it fails to lint.

`pre-commit` is a powerful tool that helps you automatically lint before you commit. If the linter complains,
the commit is aborted so that you can fix the linting errors before committing again. That way, you never commit
the problematic code in the first place!

To make linting and checking easy, we have setup pipenv scripts to faciliate installing the commit hooks, and
running the lint checks.

Here is how you can setup pre-commit with ease:

1. Ensure that you have dependencies (and dev-dependencies) installed using pipenv.
2. Once you're ready, run `pipenv run precommit`, which install the precommit hooks to check your code style
   when you're commiting it. It stops code from getting commited, if issues are discovered.
3. Finally, To run the linting manually, just use `pipenv run lint`, and you should be good to go.

**Note**: If you really need to commit code, and fix the issues or take assistance, run `git commit --no-verify`
to skips the precommit checks.

### Type Hinting

[PEP 484](https://www.python.org/dev/peps/pep-0484/) formally specifies type hints for Python functions, added
to the Python Standard Library in version 3.5. Type hints are recognized by most modern code editing tools and
provide useful insight into both the input and output types of a function, preventing the user from having to
go through the codebase to determine these types.

For an example, a function without annotations would look like:

```py
def divide(a, b):
    """Divide the two given arguments."""
    return a / b
```

With annotations, this is how the function would look:

```py
def divide(a: int, b: int) -> float:
    """Divide the two given arguments."""
    return a / b
```

Python type-hinting is relatively easy to use, but helps to keep the code more maintainable, clean, and also
enables the use of type annotations in the future. In a lot of situations, the type-hinting enables your editors
to give better intellisense and suggestions based on what you're working on.

Python being a dynamically typed language, There is a neat tool called MyPy that enables static type hinting
and checking on the code. You can read more about it [here](https://mypy.readthedocs.io/en/stable/).

### Docstring formatting directive

Many documentation packages provide support for automatic documentation generation from the codebase's docstrings.
These tools utilize special formatting directives to enable richer formatting in the generated documentation.

For example:

```py
import typing as t


def foo(bar: int, baz: t.Optional[t.Dict[str, str]] = None) -> bool:
    """
    Does some things with some stuff.

    :param bar: Some input
    :param baz: Optional, some dictionary with string keys and values

    :return: Some boolean
    """
    ...
```

Since we don't utilize automatic documentation generation, use of this syntax should not be used in the code contributed here.

Should the purpose and type of the input variables not be easily discernable from the variable name and type
annotation a prose explanation can be used. Explicit references to variables, function, classes, etc. should be
wrapped with backticks (`` ` ``), such as \`variable\`.

For example, the above docstring would become:

```py
import typing as t


def foo(bar: int, baz: t.Optional[t.Dict[str, str]] = None) -> bool:
    """
    Does some things with some stuff.

    This function takes an index, `bar` and checks for its presence in the database `baz`, passed as a dictionary.
    Returns `False` if `baz` is not passed or if `bar` wasn't found in `baz`.
    """
    ...
```

### Strings and Quotes

Preference is to use double-quotes (`"`) wherever possible. Single quotes should only be used for cases where it is
logical. Exceptions might include:

- Using a key string within an f-string: f"Today is {data['day']}".
- Using double quotes within a string: 'She said "oh dear" in response'

Multi-line strings or Docstrings should be ensured that it's wrapped in triple double quotes (`"""my string"""`).

## Deprecation notices

### Sunset of the `nftlabs-sdk` package.

The `nftlabs-sdk` pypi package will be deprecated on November 30th, 2021

Please make sure you install the new `thirdweb-sdk` package found [here](https://pypi.org/project/thirdweb-sdk)

In your code, update all imports to use the `thirdweb` package and switch to using the `ThirdwebSdk` package
(instead of the `NftlabsSdk` package)

### Collection module renamed to bundle.

The `collection` module has been renamed to `bundle` and will be deprecated on November 30th, 2021.

All references to `collection` module and its associated classes should be updated to `bundle` and its newely created classes.

You can find the detailed documentation for the `bundle` module
[here](https://python-docs.thirdweb.com/modules.bundle.html).

## Links

- [Documentation](https://docs.thirdweb.com)
- [API Reference](https://python-docs.thirdweb.com/)
- [PyPI Package](https://pypi.org/project/thirdweb-sdk)
